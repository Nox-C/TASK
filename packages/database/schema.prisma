generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Bot {
  id            Int      @id @default(autoincrement())
  name          String
  strategy      String
  exchange      String
  tradingPair   String   @map("trading_pair")
  status        String   @default("STOPPED")
  positionSize  Float    @map("position_size")
  stopLoss      Float    @map("stop_loss")
  takeProfit    Float    @map("take_profit")
  totalPnl      Float    @default(0) @map("total_pnl")
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")
  
  orders        Order[]
  pnlHistory    PnlSnapshot[]

  @@map("bots")
}

model Strategy {
  id          Int      @id @default(autoincrement())
  name        String   @unique
  description String?
  createdAt   DateTime @default(now()) @map("created_at")

  @@map("strategies")
}

model Order {
  id        Int      @id @default(autoincrement())
  botId     Int      @map("bot_id")
  symbol    String
  side      String
  type      String
  price     Float
  quantity  Float
  status    String   @default("PENDING")
  createdAt DateTime @default(now()) @map("created_at")
  
  bot       Bot      @relation(fields: [botId], references: [id], onDelete: Cascade)

  @@map("orders")
}

model PnlSnapshot {
  id        Int      @id @default(autoincrement())
  botId     Int      @map("bot_id")
  pnl       Float
  timestamp DateTime @default(now())
  
  bot       Bot      @relation(fields: [botId], references: [id], onDelete: Cascade)

  @@map("pnl_snapshots")
}
